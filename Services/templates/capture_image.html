{% extends "base.html" %}

{% block title %}Capture Images{% endblock title %}
{% block captureactive %}active{% endblock captureactive %}


{% block body %}
{% block extra_css %}
<style>
    .bg-image{
        filter: blur(8px);
    -webkit-filter: blur(8px);
    }
</style> 
{% endblock extra_css %}

{% csrf_token %}
<video id="video" autoplay playsinline width="640" height="480"></video>
<canvas id="canvas" width="640" height="480" style="display:none;"></canvas>
<button id="snap">Capture</button>

<form id="uploadForm" method="POST" enctype="multipart/form-data">
  <input type="hidden" name="image" id="imageData">
  <button type="submit">Upload Image</button>
</form>

<script>
  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  const imageInput = document.getElementById('imageData');

  // Access webcam
  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => video.srcObject = stream);

  document.getElementById('snap').addEventListener('click', () => {
    canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
    const dataURL = canvas.toDataURL('image/jpeg');
    imageInput.value = dataURL;
  });
</script>

{% endblock body %}